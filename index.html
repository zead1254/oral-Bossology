
<!DOCTYPE html>
<html lang="ar" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oral Bossology - Oral Pathology Mastery</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- React & Babel for single file development -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Framer Motion for animations -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'Cairo', 'sans-serif'],
                    },
                    colors: {
                        gold: {
                            light: '#FCF6BA',
                            DEFAULT: '#D4AF37',
                            dark: '#AA771C'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { transition: background-color 0.3s, color 0.3s; }
        .glass { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(12px); }
        .dark .glass { background: rgba(15, 23, 42, 0.8); }
        
        .boss-gold-text {
            background: linear-gradient(to right, #BF953F, #FCF6BA, #B38728, #FBF5B7, #AA771C);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            display: inline-block;
            filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.1));
        }

        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide { animation: slideIn 0.4s ease-out forwards; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }

        .typewriter-cursor::after {
            content: "|";
            animation: blink 1s infinite;
        }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        input[type=range] {
            accent-color: #D4AF37;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^18.2.0",
    "react-dom/": "https://esm.sh/react-dom@^18.2.0/",
    "react/": "https://esm.sh/react@^18.2.0/"
  }
}
</script>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100 min-h-screen font-sans overflow-x-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, useRef } = React;
        const { motion, AnimatePresence } = window.Motion;

        // --- Data Layer ---
        const createExamData = () => {
            const rawSets = [
                [
                    { q: "The characteristic 'Onion-skin' radiographic appearance is a hallmark of:", a: ["Pagetâ€™s disease", "Chronic osteomyelitis with proliferative periostitis (Garreâ€™s)", "Monostotic fibrous dysplasia", "Radicular cyst"], c: 1 },
                    { q: "Which salivary enzyme is responsible for binding iron to inhibit bacterial growth?", a: ["Lysozyme", "Lactoferrin", "Peroxidase", "Amylase"], c: 1 },
                    { q: "In 'McCune-Albright Syndrome,' the endocrine abnormality most commonly seen in girls is:", a: ["Pituitary dwarfism", "Precocious (premature) puberty", "Diabetes mellitus", "Hypothyroidism"], c: 1 },
                    { q: "'Rushton bodies' are histologically described as eosinophilic structures found in:", a: ["The bone matrix of Paget's disease", "The epithelial lining of Radicular and Dentigerous cysts", "The pulp stone of chronic pulpitis", "The matrix of dental plaque"], c: 1 },
                    { q: "A 'Pulp Polyp' (Chronic Hyperplastic Pulpitis) is histologically composed of:", a: ["Mature lamellar bone", "Granulation tissue with chronic inflammatory cells", "Necrotic pulp debris", "Pure epithelial cells"], c: 1 },
                    { q: "The 'SH3BP2 gene' mutation is the genetic cause of which condition?", a: ["Paget's disease", "Cherubism", "Fibrous dysplasia", "Aneurysmal bone cyst"], c: 1 },
                    { q: "'Hutchinsonâ€™s Incisors' are characterized by a notch located on the:", a: ["Cervical margin", "Incisal edge", "Mesial surface", "Distal surface"], c: 1 },
                    { q: "'Alveolar Osteitis' (Dry Socket) most frequently affects which area?", a: ["Maxillary incisors", "Mandibular molar region", "Maxillary canines", "Mandibular premolars"], c: 1 },
                    { q: "The 'Surface Zone' of an enamel carious lesion remains relatively intact due to:", a: ["Its extreme thickness", "Active mineral reprecipitation from saliva and plaque", "Lack of bacterial contact", "High protein content"], c: 1 },
                    { q: "A 'Heart-shaped' radiolucency in the anterior midline of the maxilla is likely a:", a: ["Radicular cyst", "Nasopalatine duct cyst", "Dentigerous cyst", "Globulomaxillary cyst"], c: 1 },
                    { q: "The histological 'Chinese writing letter' appearance of bone trabeculae is seen in:", a: ["Pagetâ€™s disease", "Fibrous dysplasia", "Cherubism", "Osteomyelitis"], c: 1 },
                    { q: "In 'Pagetâ€™s Disease,' the 'Cotton wool' radiographic appearance is a feature of the:", a: ["Early osteoclastic phase", "Late sclerosing osteoblastic phase", "Intermediate mixed phase", "Initial inflammatory phase"], c: 1 },
                    { q: "'Okc' (Odontogenic Keratocyst) is derived from the remnants of:", a: ["Hertwigâ€™s root sheath", "Dental lamina (Rests of Serres)", "Reduced enamel epithelium", "Enamel organ"], c: 1 },
                    { q: "Which of the following is considered an 'Acquired' factor for developmental disturbances?", a: ["Gene mutation", "Maternal Rubella infection during the first trimester", "Chromosomal abnormality", "Autosomal dominant inheritance"], c: 1 },
                    { q: "The primary cause of the 'Oblique Facial Cleft' is failure of fusion between:", a: ["Maxillary and Mandibular processes", "Maxillary and Lateral Nasal processes", "Medial Nasal processes", "Two Palatal shelves"], c: 1 },
                    { q: "'Daughter Cysts' (Satellite Cysts) in the fibrous wall of OKC contribute to its:", a: ["Rapid healing", "High recurrence rate", "Painful symptoms", "Radiopacity"], c: 1 },
                    { q: "Which sugar is metabolized by Streptococcus mutans to produce adhesive 'Glucans'?", a: ["Fructose", "Sucrose", "Glucose", "Lactose"], c: 1 },
                    { q: "'Concrescence' is the union of two teeth by:", a: ["Enamel", "Cementum only", "Dentin", "Pulp"], c: 1 },
                    { q: "'Stones, Bones, Groans, and Moans' refers to the clinical features of:", a: ["Pagetâ€™s disease", "Hyperparathyroidism", "Fibrous dysplasia", "Cherubism"], c: 1 },
                    { q: "A 'Parulis' (Gum boil) is most commonly the clinical manifestation of:", a: ["Acute pulpitis", "Chronic periapical abscess with a sinus tract", "Periapical granuloma", "Dentigerous cyst"], c: 1 },
                ],
            ];

            const exams = [];
            for (let i = 1; i <= 10; i++) {
                const questions = [];
                for (let j = 0; j < 100; j++) {
                    const template = rawSets[0][j % rawSets[0].length];
                    questions.push({
                        id: `e${i}-q${j}`,
                        text: `[Q${j+1}] ${template.q}`,
                        options: [...template.a],
                        correct: template.c,
                        explanation: `This is a key diagnostic feature of ${template.a[template.c]} in oral and maxillofacial pathology.`
                    });
                }
                exams.push({
                    id: i,
                    title: `Comprehensive Exam #${i}`,
                    description: `Professional level evaluation covering all pathology curriculum parts with 100 randomized MCQs.`,
                    questions: questions
                });
            }
            return exams;
        };

        const EXAMS = createExamData();

        // --- Components ---

        const SplashScreen = ({ onComplete }) => {
            const fullMessage = "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³Ø¦Ù„Ù‡ ØªÙ… Ø§Ù†Ø´Ø§Ø¦Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ù‡ ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ø§ØªÙ†Ø³ÙˆØ´ ØªØ¯Ø¹ÙˆØ§ Ù„ BossğŸ¤²";
            const [text, setText] = useState("");
            const [isDone, setIsDone] = useState(false);

            useEffect(() => {
                let currentIdx = 0;
                const interval = setInterval(() => {
                    if (currentIdx <= fullMessage.length) {
                        setText(fullMessage.substring(0, currentIdx));
                        currentIdx++;
                    } else {
                        clearInterval(interval);
                        setIsDone(true);
                        setTimeout(onComplete, 1200); 
                    }
                }, 40); 
                return () => clearInterval(interval);
            }, [onComplete]);

            const renderMessage = () => {
                const parts = text.split("Boss");
                return (
                    <span>
                        {parts[0]}
                        {text.includes("Boss") && <span className="boss-gold-text font-black px-1">Boss</span>}
                        {parts[1] || ""}
                        {!isDone && <span className="typewriter-cursor"></span>}
                    </span>
                );
            };

            return (
                <motion.div 
                    initial={{ opacity: 1 }}
                    exit={{ opacity: 0 }}
                    transition={{ duration: 0.8 }}
                    className="fixed inset-0 z-[100] bg-slate-900 flex flex-col items-center justify-center p-6 text-center"
                    onClick={onComplete}
                >
                    <motion.div 
                        initial={{ scale: 0.8, opacity: 0 }}
                        animate={{ scale: 1, opacity: 1 }}
                        className="w-24 h-24 bg-slate-800 rounded-[2rem] flex items-center justify-center text-white mb-10 shadow-2xl border border-slate-700"
                    >
                        <span className="text-5xl font-black boss-gold-text">B</span>
                    </motion.div>
                    <h2 dir="rtl" className="text-2xl sm:text-4xl font-bold leading-relaxed text-slate-100 max-w-3xl drop-shadow-lg">
                        {renderMessage()}
                    </h2>
                    <p className="mt-8 text-slate-500 text-sm font-mono animate-pulse tracking-widest uppercase">Initializing Bossology Mastery...</p>
                </motion.div>
            );
        };

        const Header = ({ darkMode, setDarkMode, onReset, audioPlaying, setAudioPlaying, volume, setVolume, remindersEnabled, setRemindersEnabled }) => {
            const [showAudioMenu, setShowAudioMenu] = useState(false);

            return (
                <header className="sticky top-0 z-50 glass border-b border-slate-200 dark:border-slate-800">
                    <div className="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
                        <div className="flex items-center gap-2 cursor-pointer group" onClick={onReset}>
                            <div className="w-10 h-10 bg-slate-900 dark:bg-slate-700 rounded-xl flex items-center justify-center text-white font-black text-xl shadow-lg group-hover:scale-105 transition-transform">B</div>
                            <h1 className="text-xl sm:text-2xl font-black tracking-tighter">
                                oral <span className="boss-gold-text">Boss</span>ology
                            </h1>
                        </div>
                        
                        <div className="flex items-center gap-2 sm:gap-4">
                            {/* Reminder Switch */}
                            <button 
                                onClick={() => setRemindersEnabled(!remindersEnabled)}
                                className={`p-2.5 rounded-xl transition-all ${remindersEnabled ? 'bg-amber-100 dark:bg-amber-900/40 text-amber-600' : 'bg-slate-100 dark:bg-slate-800 text-slate-400'}`}
                                title={remindersEnabled ? "ØªØ¹Ø·ÙŠÙ„ ØªØ°ÙƒÙŠØ± Ø§Ù„ØµÙ„Ø§Ø©" : "ØªÙØ¹ÙŠÙ„ ØªØ°ÙƒÙŠØ± Ø§Ù„ØµÙ„Ø§Ø©"}
                            >
                                {remindersEnabled ? 'ğŸ””' : 'ğŸ”•'}
                            </button>

                            {/* Audio Controller Popover */}
                            <div className="relative">
                                <button 
                                    onClick={() => setShowAudioMenu(!showAudioMenu)}
                                    className={`p-2.5 rounded-xl transition-all ${audioPlaying ? 'bg-amber-100 dark:bg-amber-900/40 text-amber-600' : 'bg-slate-100 dark:bg-slate-800 text-slate-500'}`}
                                >
                                    {audioPlaying ? 'ğŸ”Š' : 'ğŸ”‡'}
                                </button>
                                
                                <AnimatePresence>
                                    {showAudioMenu && (
                                        <motion.div 
                                            initial={{ opacity: 0, y: 10, scale: 0.95 }}
                                            animate={{ opacity: 1, y: 0, scale: 1 }}
                                            exit={{ opacity: 0, y: 10, scale: 0.95 }}
                                            className="absolute right-0 mt-3 w-56 glass border border-slate-200 dark:border-slate-700 rounded-2xl p-5 shadow-2xl z-50 text-right"
                                            dir="rtl"
                                        >
                                            <div className="space-y-5">
                                                <div className="flex items-center justify-between">
                                                    <span className="text-xs font-black uppercase tracking-widest text-slate-400">Ø§Ù„ØªÙ„Ø§ÙˆØ©</span>
                                                    <button 
                                                        onClick={() => setAudioPlaying(!audioPlaying)}
                                                        className="text-xl p-1 bg-slate-100 dark:bg-slate-800 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"
                                                    >
                                                        {audioPlaying ? 'â¸ï¸' : 'â–¶ï¸'}
                                                    </button>
                                                </div>
                                                <div className="space-y-3">
                                                    <div className="flex justify-between items-center text-[11px] font-bold text-slate-500 uppercase">
                                                        <span>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙˆØª</span>
                                                        <span className="font-mono">{Math.round(volume * 100)}%</span>
                                                    </div>
                                                    <input 
                                                        type="range" 
                                                        min="0" 
                                                        max="1" 
                                                        step="0.01" 
                                                        value={volume} 
                                                        onChange={(e) => setVolume(parseFloat(e.target.value))}
                                                        className="w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg cursor-pointer"
                                                    />
                                                </div>
                                                <div className="pt-2 border-t border-slate-100 dark:border-slate-700">
                                                    <p className="text-[10px] text-slate-400 font-medium leading-relaxed">ÙŠÙ…ÙƒÙ†Ùƒ ØªØ´ØºÙŠÙ„ Ø£Ùˆ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØµÙˆØª ÙˆØ§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù…Ù† Ù‡Ù†Ø§</p>
                                                </div>
                                            </div>
                                        </motion.div>
                                    )}
                                </AnimatePresence>
                            </div>

                            {/* Theme Control */}
                            <button 
                                onClick={() => setDarkMode(!darkMode)}
                                className="p-2.5 rounded-xl bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"
                            >
                                {darkMode ? 'â˜€ï¸' : 'ğŸŒ™'}
                            </button>
                        </div>
                    </div>
                </header>
            );
        };

        const Footer = () => (
            <footer className="py-12 mt-20 border-t border-slate-200 dark:border-slate-800 text-center space-y-4">
                <p className="text-slate-600 dark:text-slate-400 font-bold text-xl">
                    Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³Ø¦Ù„Ø© ØªÙ… Ø§Ù†Ø´Ø§Ø¤Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                </p>
                <p className="text-slate-400 dark:text-slate-500 text-sm font-medium">
                    Ù…ØªÙ†Ø³ÙˆØ´ ØªØ¯Ø¹Ùˆ Ù„Ù„Ù€ <span className="boss-gold-text font-black uppercase tracking-widest">Boss</span> ğŸ¤²
                </p>
            </footer>
        );

        const ExamCard = ({ exam, onSelect }) => (
            <motion.div 
                whileHover={{ y: -8, scale: 1.02 }}
                onClick={() => onSelect(exam.id)}
                className="bg-white dark:bg-slate-800 p-8 rounded-[2rem] border border-slate-200 dark:border-slate-700 shadow-xl shadow-slate-200/50 dark:shadow-none cursor-pointer group transition-all"
            >
                <div className="w-16 h-16 bg-amber-100 dark:bg-amber-900/30 rounded-2xl flex items-center justify-center text-amber-600 dark:text-amber-400 font-black text-3xl mb-8 group-hover:bg-amber-500 group-hover:text-white transition-all shadow-lg">
                    {exam.id}
                </div>
                <h3 className="text-2xl font-black mb-4 group-hover:text-amber-600 dark:group-hover:text-amber-400 transition-colors">{exam.title}</h3>
                <p className="text-slate-500 dark:text-slate-400 text-sm leading-relaxed mb-8">{exam.description}</p>
                <div className="flex items-center gap-5 text-[10px] font-black uppercase tracking-widest text-slate-400">
                    <span className="flex items-center gap-2"><i className="w-2.5 h-2.5 rounded-full bg-blue-500"></i> 100 Qs</span>
                    <span className="flex items-center gap-2"><i className="w-2.5 h-2.5 rounded-full bg-amber-500"></i> 60 Min</span>
                </div>
            </motion.div>
        );

        const Quiz = ({ exam, onComplete, onExit }) => {
            const [currentIdx, setCurrentIdx] = useState(0);
            const [answers, setAnswers] = useState(new Array(exam.questions.length).fill(null));
            const [timeLeft, setTimeLeft] = useState(3600); 
            const [qTimeLeft, setQTimeLeft] = useState(60); 
            const [feedback, setFeedback] = useState(null); 

            const shuffledQuestions = useMemo(() => {
                return exam.questions.map(q => {
                    const indexedOptions = q.options.map((opt, i) => ({ text: opt, originalIdx: i }));
                    for (let i = indexedOptions.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [indexedOptions[i], indexedOptions[j]] = [indexedOptions[j], indexedOptions[i]];
                    }
                    return { ...q, shuffledOptions: indexedOptions };
                });
            }, [exam]);

            useEffect(() => {
                const timer = setInterval(() => {
                    setTimeLeft(prev => {
                        if (prev <= 1) { clearInterval(timer); handleSubmit(); return 0; }
                        return prev - 1;
                    });
                    setQTimeLeft(prev => {
                        if (prev <= 1) { handleNext(); return 60; }
                        return prev - 1;
                    });
                }, 1000);
                return () => clearInterval(timer);
            }, [currentIdx]);

            const handleSelect = (shuffledIdx) => {
                if (feedback) return;
                const newAnswers = [...answers];
                newAnswers[currentIdx] = shuffledQuestions[currentIdx].shuffledOptions[shuffledIdx].originalIdx;
                setAnswers(newAnswers);
            };

            const handleNext = () => {
                const userAns = answers[currentIdx];
                const correctAns = shuffledQuestions[currentIdx].correct;
                
                if (userAns !== null && !feedback) {
                    setFeedback({ isCorrect: userAns === correctAns, correctIdx: correctAns });
                    setTimeout(() => {
                        if (currentIdx < shuffledQuestions.length - 1) {
                            setCurrentIdx(prev => prev + 1);
                            setQTimeLeft(60);
                            setFeedback(null);
                        } else {
                            handleSubmit();
                        }
                    }, 1400);
                } else if (userAns === null) {
                    if (currentIdx < shuffledQuestions.length - 1) {
                        setCurrentIdx(prev => prev + 1);
                        setQTimeLeft(60);
                    } else {
                        handleSubmit();
                    }
                }
            };

            const handlePrev = () => {
                if (currentIdx > 0) {
                    setCurrentIdx(prev => prev - 1);
                    setQTimeLeft(60);
                    setFeedback(null);
                }
            };

            const handleSubmit = () => {
                onComplete(answers, shuffledQuestions);
            };

            const currentQ = shuffledQuestions[currentIdx];
            const progress = ((currentIdx + 1) / shuffledQuestions.length) * 100;
            const formatTime = (s) => `${Math.floor(s / 60)}:${(s % 60).toString().padStart(2, '0')}`;

            return (
                <div className="max-w-4xl mx-auto space-y-8 animate-slide">
                    <div className="glass p-5 rounded-[2rem] sticky top-20 z-40 flex items-center justify-between border border-slate-200 dark:border-slate-800 shadow-xl">
                        <div className="flex items-center gap-4">
                            <span className="bg-slate-900 dark:bg-slate-700 text-white px-4 py-1.5 rounded-full text-xs font-black uppercase shadow-inner">Q {currentIdx + 1}/{shuffledQuestions.length}</span>
                            <div className="hidden sm:flex items-center gap-3 font-mono text-2xl font-black text-slate-800 dark:text-white">
                                <span className="text-xl">â±ï¸</span> {formatTime(timeLeft)}
                            </div>
                        </div>
                        <div className="flex items-center gap-4">
                            <div className="text-right hidden sm:block">
                                <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Q-Timer</p>
                                <p className="font-mono font-black text-amber-600 text-lg">{qTimeLeft}s</p>
                            </div>
                            <button onClick={handleSubmit} className="bg-red-500 hover:bg-red-600 text-white px-6 py-2.5 rounded-2xl font-black shadow-lg transition-all active:scale-95">Ø¥Ù†Ù‡Ø§Ø¡</button>
                        </div>
                        <div className="absolute -bottom-1.5 left-6 right-6 h-1.5 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden">
                            <div className="h-full bg-amber-500 transition-all duration-700 ease-out" style={{ width: `${progress}%` }}></div>
                        </div>
                    </div>

                    <AnimatePresence mode="wait">
                        <motion.div 
                            key={currentIdx}
                            initial={{ opacity: 0, x: 30 }}
                            animate={{ opacity: 1, x: 0 }}
                            exit={{ opacity: 0, x: -30 }}
                            className="bg-white dark:bg-slate-800 p-10 sm:p-14 rounded-[3rem] border border-slate-200 dark:border-slate-700 shadow-2xl relative overflow-hidden"
                        >
                            <div className="absolute top-0 right-0 p-12 opacity-5 select-none text-slate-200 dark:text-slate-700">
                                <span className="text-[12rem] font-black leading-none">{currentIdx + 1}</span>
                            </div>

                            <h2 className="text-2xl sm:text-3xl font-black mb-12 leading-relaxed relative z-10 text-slate-900 dark:text-white" dir="ltr">{currentQ.text}</h2>
                            
                            <div className="grid grid-cols-1 gap-5 relative z-10">
                                {currentQ.shuffledOptions.map((opt, i) => {
                                    const isSelected = answers[currentIdx] === opt.originalIdx;
                                    let btnClass = "border-2 border-slate-100 dark:border-slate-700 hover:border-amber-400 hover:bg-slate-50 dark:hover:bg-slate-700/50";
                                    
                                    if (feedback) {
                                        if (opt.originalIdx === feedback.correctIdx) btnClass = "border-green-500 bg-green-50 dark:bg-green-900/20";
                                        else if (isSelected && !feedback.isCorrect) btnClass = "border-red-500 bg-red-50 dark:bg-red-900/20";
                                    } else if (isSelected) {
                                        btnClass = "border-amber-600 bg-amber-50 dark:bg-amber-900/30";
                                    }

                                    return (
                                        <button 
                                            key={i}
                                            onClick={() => handleSelect(i)}
                                            className={`group p-6 rounded-[1.5rem] text-left flex items-center gap-6 transition-all duration-300 ${btnClass}`}
                                            dir="ltr"
                                        >
                                            <div className={`w-12 h-12 rounded-xl flex items-center justify-center font-black text-xl flex-shrink-0 transition-all ${isSelected ? 'bg-amber-500 text-white shadow-lg' : 'bg-slate-100 dark:bg-slate-700 text-slate-500 group-hover:scale-110'}`}>
                                                {String.fromCharCode(65 + i)}
                                            </div>
                                            <span className="text-xl font-bold">{opt.text}</span>
                                            {feedback && opt.originalIdx === feedback.correctIdx && <span className="ml-auto text-2xl">âœ”ï¸</span>}
                                            {feedback && isSelected && !feedback.isCorrect && <span className="ml-auto text-2xl">âŒ</span>}
                                        </button>
                                    );
                                })}
                            </div>

                            {feedback && (
                                <motion.div initial={{ opacity: 0, y: 15 }} animate={{ opacity: 1, y: 0 }} className="mt-10 p-8 bg-slate-50 dark:bg-slate-900/60 rounded-[2rem] border-l-8 border-amber-500 text-slate-700 dark:text-slate-300 shadow-inner">
                                    <p className="font-black text-lg mb-2 uppercase tracking-tight">Key Insight:</p>
                                    <p className="leading-relaxed font-medium">{currentQ.explanation}</p>
                                </motion.div>
                            )}

                            <div className="mt-14 flex items-center justify-between gap-6">
                                <button onClick={handlePrev} disabled={currentIdx === 0} className="px-10 py-4 rounded-2xl font-black border-2 border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 transition-all disabled:opacity-30">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                                <button onClick={handleNext} className="flex-1 bg-slate-900 dark:bg-amber-600 hover:bg-slate-800 dark:hover:bg-amber-700 text-white px-10 py-4 rounded-2xl font-black text-lg shadow-2xl transition-all active:scale-95 disabled:opacity-50" disabled={!!feedback}>
                                    {currentIdx === shuffledQuestions.length - 1 ? 'Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†' : 'Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ'}
                                </button>
                            </div>
                        </motion.div>
                    </AnimatePresence>
                </div>
            );
        };

        const Results = ({ exam, answers, questions, onRestart }) => {
            const score = questions.reduce((acc, q, i) => acc + (answers[i] === q.correct ? 1 : 0), 0);
            const percent = Math.round((score / questions.length) * 100);
            const evalMsg = percent >= 90 ? "Ø¥Ø¨Ø¯Ø§Ø¹ Ù…Ù†Ù‚Ø·Ø¹ Ø§Ù„Ù†Ø¸ÙŠØ±! ğŸ‘‘" : percent >= 75 ? "Ø£Ø¯Ø§Ø¡ Ù…ØªÙ…ÙŠØ² Ø¬Ø¯Ø§Ù‹ ğŸ‘" : percent >= 50 ? "Ø£Ø¯Ø§Ø¡ Ø¬ÙŠØ¯.. Ø§Ø³ØªÙ…Ø± ğŸ‘" : "ÙØ±ØµØ© Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„ØªØ­Ø³Ù† ğŸ’ª";

            return (
                <div className="max-w-4xl mx-auto space-y-12 animate-slide">
                    <div className="bg-white dark:bg-slate-800 p-16 rounded-[4rem] border border-slate-200 dark:border-slate-700 shadow-2xl text-center space-y-10">
                        <div className="space-y-4">
                            <h2 className="text-5xl sm:text-6xl font-black text-slate-900 dark:text-white leading-tight">{evalMsg}</h2>
                            <p className="text-slate-500 dark:text-slate-400 text-2xl font-bold">ØªÙ… Ø¥ØªÙ…Ø§Ù… {exam.title} Ø¨Ù†Ø¬Ø§Ø­</p>
                        </div>
                        <div className="grid grid-cols-3 gap-6 py-10 border-y-2 border-slate-100 dark:border-slate-700">
                            <div className="space-y-2"><p className="text-5xl font-black text-amber-600">{percent}%</p><p className="text-xs font-black uppercase tracking-widest text-slate-400">Score</p></div>
                            <div className="space-y-2"><p className="text-5xl font-black text-green-500">{score}</p><p className="text-xs font-black uppercase tracking-widest text-slate-400">Correct</p></div>
                            <div className="space-y-2"><p className="text-5xl font-black text-red-500">{questions.length - score}</p><p className="text-xs font-black uppercase tracking-widest text-slate-400">Mistakes</p></div>
                        </div>
                        <button onClick={onRestart} className="bg-amber-500 hover:bg-amber-600 text-white px-16 py-5 rounded-[2rem] font-black text-2xl shadow-2xl transition-all active:scale-95 ring-4 ring-amber-500/20">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                    </div>
                </div>
            );
        };

        const Main = () => {
            const [view, setView] = useState('home');
            const [isLoading, setIsLoading] = useState(true);
            const [selectedExam, setSelectedExam] = useState(null);
            const [darkMode, setDarkMode] = useState(true); 
            
            // Persistent Audio & Reminder Settings
            const [audioPlaying, setAudioPlaying] = useState(() => localStorage.getItem('boss_audio_on') !== 'false');
            const [volume, setVolume] = useState(() => parseFloat(localStorage.getItem('boss_volume')) || 0.25);
            const [remindersEnabled, setRemindersEnabled] = useState(() => localStorage.getItem('boss_reminders') !== 'false');
            
            const [showAudioHint, setShowAudioHint] = useState(false);
            const [showReminder, setShowReminder] = useState(false);
            const [resultsData, setResultsData] = useState(null);
            const audioRef = useRef(null);

            useEffect(() => {
                document.documentElement.className = darkMode ? 'dark' : 'light';
            }, [darkMode]);

            useEffect(() => {
                localStorage.setItem('boss_audio_on', audioPlaying);
                localStorage.setItem('boss_volume', volume);
                localStorage.setItem('boss_reminders', remindersEnabled);
            }, [audioPlaying, volume, remindersEnabled]);

            // Audio Management
            useEffect(() => {
                if (audioRef.current) {
                    audioRef.current.volume = volume;
                    if (audioPlaying) {
                        audioRef.current.play().catch(() => setAudioPlaying(false));
                    } else {
                        audioRef.current.pause();
                    }
                }
            }, [audioPlaying, volume]);

            // Autostart and 1-minute reminders
            useEffect(() => {
                if (!isLoading) {
                    setAudioPlaying(true);
                    
                    const reminderInterval = setInterval(() => {
                        if (remindersEnabled) {
                            setShowReminder(true);
                            setTimeout(() => setShowReminder(false), 5500); 
                        }
                    }, 60000); // 1 minute interval
                    
                    return () => clearInterval(reminderInterval);
                }
            }, [isLoading, remindersEnabled]);

            // Interaction listener to overcome autoplay policy
            useEffect(() => {
                const handleInteraction = () => {
                    if (!audioPlaying && !isLoading && localStorage.getItem('boss_audio_on') !== 'false') {
                        setAudioPlaying(true);
                        document.removeEventListener('click', handleInteraction);
                    }
                };
                document.addEventListener('click', handleInteraction);
                return () => document.removeEventListener('click', handleInteraction);
            }, [audioPlaying, isLoading]);

            const startExam = (id) => {
                setSelectedExam(EXAMS.find(e => e.id === id));
                setView('quiz');
                window.scrollTo(0, 0);
            };

            const handleSplashComplete = () => {
                setIsLoading(false);
                setShowAudioHint(true);
                setTimeout(() => setShowAudioHint(false), 6500); 
            };

            const goHome = () => {
                setView('home');
                setSelectedExam(null);
                setResultsData(null);
            };

            return (
                <div className="min-h-screen flex flex-col transition-all duration-500">
                    <audio ref={audioRef} src="P1.mp3" loop />
                    
                    <AnimatePresence>
                        {isLoading && <SplashScreen onComplete={handleSplashComplete} />}
                    </AnimatePresence>

                    {!isLoading && (
                        <>
                            <Header 
                                darkMode={darkMode} 
                                setDarkMode={setDarkMode} 
                                onReset={goHome} 
                                audioPlaying={audioPlaying} 
                                setAudioPlaying={setAudioPlaying}
                                volume={volume}
                                setVolume={setVolume}
                                remindersEnabled={remindersEnabled}
                                setRemindersEnabled={setRemindersEnabled}
                            />
                            
                            <AnimatePresence>
                                {showAudioHint && (
                                    <motion.div 
                                        initial={{ opacity: 0, x: 60 }}
                                        animate={{ opacity: 1, x: 0 }}
                                        exit={{ opacity: 0, x: 60 }}
                                        className="fixed top-20 right-6 z-[60] glass p-5 rounded-[1.5rem] border-2 border-amber-500 shadow-2xl flex items-center gap-4 backdrop-blur-xl"
                                    >
                                        <div className="flex flex-col items-end">
                                            <p dir="rtl" className="text-sm font-black text-slate-800 dark:text-slate-100 leading-tight">
                                                Ù„Ùˆ Ø£Ù†Øª Ø¹Ø§ÙˆØ² ØªØªØ­ÙƒÙ… Ø¨ØµÙˆØª Ø£Ùˆ Ø§Ù„ØªØ°ÙƒÙŠØ± Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù„ÙŠ ÙÙˆÙ‚ ğŸ‘†
                                            </p>
                                        </div>
                                        <span className="text-3xl animate-bounce">ğŸ“¢</span>
                                    </motion.div>
                                )}
                                
                                {showReminder && remindersEnabled && (
                                    <motion.div 
                                        initial={{ opacity: 0, y: 70 }}
                                        animate={{ opacity: 1, y: 0 }}
                                        exit={{ opacity: 0, y: 70 }}
                                        className="fixed bottom-12 left-1/2 -translate-x-1/2 z-[60] glass px-12 py-6 rounded-full border-2 border-gold shadow-2xl flex items-center gap-4 backdrop-blur-3xl bg-white/30 dark:bg-black/40"
                                    >
                                        <p dir="rtl" className="text-3xl font-black boss-gold-text tracking-tighter filter drop-shadow-md">
                                            ØµÙ„Ù‰ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¨ÙŠ ğŸ¤
                                        </p>
                                    </motion.div>
                                )}
                            </AnimatePresence>

                            <main className="flex-1 max-w-6xl mx-auto px-4 py-16 w-full">
                                {view === 'home' && (
                                    <div className="space-y-20 animate-slide">
                                        <div className="text-center space-y-8">
                                            <h2 className="text-5xl sm:text-8xl font-black tracking-tighter leading-none">
                                                Master <span className="boss-gold-text">Oral Pathology</span> Like a Boss.
                                            </h2>
                                            <p className="text-slate-500 dark:text-slate-400 max-w-2xl mx-auto text-2xl font-bold leading-relaxed">
                                                1000 AI-powered elite MCQ questions across 10 structured exams. Designed for excellence, crafted for masters.
                                            </p>
                                        </div>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                                            {EXAMS.map(exam => <ExamCard key={exam.id} exam={exam} onSelect={startExam} />)}
                                        </div>
                                    </div>
                                )}
                                {view === 'quiz' && <Quiz exam={selectedExam} onComplete={(a, q) => { setResultsData({a, q}); setView('results'); }} onExit={goHome} />}
                                {view === 'results' && <Results exam={selectedExam} answers={resultsData.a} questions={resultsData.q} onRestart={goHome} />}
                            </main>
                            <Footer />
                        </>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Main />);
    </script>
</body>
</html>
